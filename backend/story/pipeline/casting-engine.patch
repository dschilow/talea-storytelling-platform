*** Begin Patch
*** Update File: backend/story/pipeline/casting-engine.ts
@@
 function selectCandidateForSlot(
   slot: RoleSlot,
   pool: CharacterPoolRow[],
   used: Set<string>,
   rng: ReturnType<typeof createSeededRandom>,
   matchScores: MatchScore[]
 ): CharacterSheet | null {
-  const candidates = pool.filter(candidate => !used.has(candidate.id));
+  const candidates = pool.filter(candidate => !used.has(candidate.id) && passesHardConstraints(slot, candidate));
@@
 }
+
+function passesHardConstraints(slot: RoleSlot, candidate: CharacterPoolRow): boolean {
+  const constraints = (slot.constraints || []).map(c => c.toLowerCase());
+  const genderConstraint = constraints.find(c => c.startsWith("gender="));
+  const ageConstraint = constraints.find(c => c.startsWith("age="));
+  const speciesConstraint = constraints.find(c => c.startsWith("species="));
+
+  if (genderConstraint) {
+    const required = genderConstraint.split("=")[1];
+    const actual = (candidate.gender || "any").toLowerCase();
+    if (actual !== "any" && actual !== required && actual !== "neutral") {
+      return false;
+    }
+  }
+
+  if (ageConstraint) {
+    const required = ageConstraint.split("=")[1];
+    const actual = (candidate.age_category || "any").toLowerCase();
+    if (actual !== "any" && actual !== required) {
+      return false;
+    }
+  }
+
+  if (speciesConstraint) {
+    const required = speciesConstraint.split("=")[1];
+    const actual = (candidate.species_category || "any").toLowerCase();
+    if (actual !== "any" && actual !== required) {
+      return false;
+    }
+  }
+
+  if (constraints.includes("avoidmodern") || constraints.includes("no modern")) {
+    const modernTags = ["pilot", "engineer", "programmer", "police", "doctor", "scientist"];
+    const tags = (candidate.profession_tags || []).map(t => t.toLowerCase()).join(" ");
+    if (modernTags.some(tag => tags.includes(tag))) {
+      return false;
+    }
+  }
+
+  return true;
+}
*** End Patch
